I"õL<ul id="markdown-toc">
  <li><a href="#æ¨¡å‹æ¦‚è¿°" id="markdown-toc-æ¨¡å‹æ¦‚è¿°">æ¨¡å‹æ¦‚è¿°</a>    <ul>
      <li><a href="#æœ€ä¼˜è§£" id="markdown-toc-æœ€ä¼˜è§£">æœ€ä¼˜è§£</a></li>
      <li><a href="#æ ¸å‡½æ•°" id="markdown-toc-æ ¸å‡½æ•°">æ ¸å‡½æ•°</a></li>
      <li><a href="#è½¯é—´éš”svm" id="markdown-toc-è½¯é—´éš”svm">è½¯é—´éš”SVM</a></li>
      <li><a href="#svr" id="markdown-toc-svr">SVR</a></li>
      <li><a href="#svm-vs-lr" id="markdown-toc-svm-vs-lr">SVM V.S. LR</a></li>
      <li><a href="#å…³äºå¯¹å¶é—®é¢˜" id="markdown-toc-å…³äºå¯¹å¶é—®é¢˜">å…³äºå¯¹å¶é—®é¢˜</a></li>
    </ul>
  </li>
</ul>

<h1 id="æ¨¡å‹æ¦‚è¿°">æ¨¡å‹æ¦‚è¿°</h1>

<p>é¦–å…ˆå›é¡¾ä¸€ä¸‹Logistic Regressionï¼Œå¯¹äºä¸€ç»„æ•°æ®$X$ä¸æ ‡ç­¾$Y$ï¼ŒLogistic Regressionçš„ä»»åŠ¡æ˜¯è¦æ‰¾åˆ°ä¸€ç»„å‚æ•°ä½¿å¾—$X\theta^{T}=threshold$ï¼Œå¯¹äº$x\theta^{T}\lt{threshold}$çš„æ ·æœ¬åˆ¤å®šä¸ºè´Ÿæ ·æœ¬ï¼Œè€Œå¯¹äº$x\theta^{T}\gt{threshold}$çš„æ ·æœ¬åˆ¤å®šä¸ºæ­£æ ·æœ¬ï¼Œå…¶æ˜¯ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ã€‚é—®é¢˜åœ¨äºï¼Œå¦‚æœæœ‰ä¸€ä¸ªç†æƒ³æ•°æ®é›†çº¿æ€§å¯åˆ†ï¼Œé‚£ä¹ˆæ¨¡å‹ä¼šå› ä¸ºå‚æ•°çš„ä¸åŒè€Œå…·æœ‰ä¸åŒçš„å†³ç­–è¾¹ç•Œï¼Œé‚£ä¹ˆåœ¨è¿™äº›å†³ç­–è¾¹ç•Œä¸­å¦‚ä½•åˆ¤å®šå­°ä¼˜å­°åŠ£ï¼Ÿ</p>

<p><img src="/img/separating-lines.png" alt="" /></p>

<p>å¯¹äºLogistic Regressionè¿™ç§æ¦‚ç‡æ¨¡å‹è€Œè¨€ï¼Œåœ¨ç»™å®šä¸€ä¸ªç¡®å®šçš„thresholdä¹‹åï¼Œå°±å¯ä»¥ç”»å‡ºå…¶å†³ç­–è¾¹ç•Œï¼Œç©ºé—´ä¸­çš„æ ·æœ¬ç‚¹ç¦»å†³ç­–è¾¹ç•Œè¶Šè¿œï¼Œè¯´æ˜æ¨¡å‹å¯¹è¯¥æ ·æœ¬çš„åˆ¤å®šå¯ä¿¡åº¦è¶Šé«˜ã€‚é‚£ä¹ˆï¼Œåœ¨è‹¥å¹²å†³ç­–è¾¹ç•Œä¸­ï¼Œåªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªå†³ç­–è¾¹ç•Œï¼Œä½¿å¾—æ¨¡å‹å¯¹ä¸¤ä¸ªç±»åˆ«çš„åˆ¤å®šå¯ä¿¡åº¦å‡æœ€é«˜å³å¯è·å¾—ä¸€ä¸ªæœ€ä¼˜åˆ†ç±»å™¨ã€‚ç”±æ­¤å¼•å‡º<strong>æ”¯æŒå‘é‡æœº</strong>(Support Vector Machine)ï¼š</p>

<p>æ•°æ®é›†$X=[x^{(1)},x^{(2)},â€¦,x^{(m)}]^{T}$ï¼Œæ ‡ç­¾$Y=[y^{(1)},y^{(2)},â€¦,y^{(m)}]\in{+1,-1}$ï¼Œä¸ºäº†å®ç°åˆ†ç±»çš„ç›®çš„ï¼Œéœ€è¦æ‰¾åˆ°ä¸€ç»„å‚æ•°æ»¡è¶³$x\theta^{T}+\theta_{0}=0$ï¼ŒåŒæ—¶è¿˜éœ€è¦æ»¡è¶³$X$ä¸­çš„å„æ ·æœ¬ç‚¹ç¦»å†³ç­–è¾¹ç•Œ$x\theta^{T}=0$çš„è·ç¦»æœ€è¿œã€‚</p>

<p>SVMæ¨¡å‹å¯¹æœªçŸ¥æ ·æœ¬çš„é¢„æµ‹è®¡ç®—å¦‚ä¸‹ï¼š</p>

\[\hat{y}=
\left\{
\begin{aligned}
&amp;+1,  &amp;\hat{x}\theta^{T}+\theta_{0}\ge+1\\
&amp;-1,  &amp;\hat{x}\theta^{T}+\theta_{0}\le-1 \\
\end{aligned}
\right.\]

<p>æ¢å¥è¯è¯´ï¼ŒSVMæ¨¡å‹çš„å†³ç­–è¾¹ç•Œå®é™…ä¸Šæ˜¯ç”±ä¸¤æ¡ç›´çº¿å†³å®šçš„ï¼š</p>

\[x\theta^{T}+\theta_{1}=+1 \\
x\theta^{T}+\theta_{2}=-1\]

<p>åœ¨è®­ç»ƒæ•°æ®é›†ä¸­ï¼Œæ»¡è¶³ä»¥ä¸Šç›´çº¿æ–¹ç¨‹çš„æ ·æœ¬ç‚¹å°±è¢«ç§°ä¸º<strong>æ”¯æŒå‘é‡</strong>(support vector)ã€‚æ ¹æ®å¹³è¡Œç›´çº¿è·ç¦»å…¬å¼
\(\frac{|C_{1}-C_{2}|}{\sqrt{A^{2}+B^{2}}}\)
å¾—è¿™ä¸¤æ¡ç›´çº¿ä¹‹é—´çš„è·ç¦»ä¸ºï¼š
\(d=\frac{2}{||\theta||_{2}}\)</p>

<p><img src="/img/494px-SVM_margin.png" alt="" /></p>

<p>å¯¹åˆ†ç±»ä»»åŠ¡è€Œè¨€ï¼Œè¿˜éœ€è¦æ»¡è¶³åˆ†ç±»çš„å‡†ç¡®æ€§ï¼Œå‡è®¾æ•°æ®æ˜¯çº¿æ€§å¯åˆ†çš„ï¼Œåˆ™æœ‰ï¼š</p>

\[y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1\]

<p>æ‰€ä»¥SVMå¯ä»¥ç”¨å¦‚ä¸‹è¡¨è¾¾å¼æ¥æè¿°ï¼š</p>

\[\theta^{*}=\arg\max\limits_{\theta} \ \frac{2}{||\theta||_{2}}, \qquad s.t. \  y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1,i=1,...m\]

<p>ä¸Šå¼ç­‰ä»·äºï¼š</p>

\[\theta^{*}=\arg\min\limits_{\theta} \ \frac{1}{2}||\theta||_{2}, \qquad s.t. \  y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1,i=1,...m\]

<p>å®¹æ˜“çœ‹å‡ºSVMè‡ªå¸¦å‚æ•°æ­£åˆ™åŒ–ã€‚</p>

<p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹SVMçš„æŸå¤±å‡½æ•°ï¼ŒSVMåªå…³å¿ƒé‚£äº›è¢«è¯¯åˆ†çš„ç‚¹ï¼Œè€Œå¯¹äºæ­£ç¡®åˆ†ç±»çš„ç‚¹æ˜¯ä¸è®¡å…¥lossçš„ï¼Œç”±å‡ ä½•çŸ¥è¯†æ˜“å¾—ï¼Œæ¨¡å‹å¯¹<strong>è¢«æ­£ç¡®åˆ†ç±»</strong>çš„ç‚¹çš„è¾“å‡ºæ€»æ˜¯æ»¡è¶³ï¼š$y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1$ï¼Œæ‰€ä»¥SVMçš„æŸå¤±å‡½æ•°å¯ä»¥å†™æˆï¼š</p>

\[Loss_{SVM}=\frac{1}{2}||\theta||_{2}+max(0,1-y(x\theta+\theta_{0}))\]

<p>ä»¥ä¸Šæ˜¯æ•°æ®å¯åˆ†çš„æƒ…å†µï¼Œé‚£ä¹ˆå¦‚æœæ•°æ®ä¸å¯åˆ†å‘¢ï¼Ÿé‚£ä¹ˆå…è®¸æŸäº›é¢„æµ‹æ ·æœ¬ä¸ä¸€å®šè¦ä¸¥æ ¼åœ¨ç›´çº¿å¤–ä¾§ï¼Œå…è®¸æŸäº›æ ·æœ¬å¤„äºç›´çº¿çš„å†…ä¾§ï¼Œé‚£ä¹ˆè¿™äº›è¢«â€œå®¹å¿â€çš„æ ·æœ¬å°±ä¸æ»¡è¶³$y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1$äº†ï¼Œä¸ºäº†é‡åŒ–è¿™äº›è¢«â€œå®¹å¿â€çš„æ ·æœ¬åç¦»æ­£è½¨çš„ç¨‹åº¦ï¼Œä¸ºæ¯ä¸€ä¸ªæ ·æœ¬å¼•å…¥ä¸€ä¸ª<strong>æ¾å¼›å˜é‡</strong>(slack variables)$\xi_{i}$ï¼Œè¿™äº›æ ·æœ¬éœ€è¦æ»¡è¶³çš„æ¡ä»¶å°±å˜ä¸ºä¸‹å¼ï¼š</p>

\[y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1-\xi_{i}\]

<p>å¾ˆæ˜¾ç„¶$\xi_{i}\ge0$ï¼Œå¹¶ä¸”è¯¥å˜é‡ä½“ç°äº†æ¨¡å‹å…è®¸æ ·æœ¬è¶Šç•Œçš„ç¨‹åº¦ã€‚é‚£ä¹ˆè‡ªç„¶è€Œç„¶åœ°ä¼šæƒ³åˆ°è¿™ä¸ªè¶Šç•Œç¨‹åº¦ä¸èƒ½æ˜¯æ— é™åˆ¶çš„ï¼Œæ‰€ä»¥è¿˜è¦å¯¹è¯¥å˜é‡è¿›è¡Œé™åˆ¶ï¼Œå› æ­¤SVMé—®é¢˜å°±å˜æˆï¼š</p>

\[\begin{aligned}
\theta^{*}=\arg\min\limits_{\theta} \ \frac{1}{2}||\theta||_{2}+C\sum_{i=1}^{m}\xi_{i}, \qquad s.t.&amp; \  y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1-\xi_{i},i=1,...m \\
&amp; \  \xi_{i}\ge0,i=1,...m \\
\end{aligned}\]

<p>å…¶ä¸­$C$ä¸ºæ ·æœ¬è¶Šç•Œçš„ä»£ä»·ç³»æ•°ï¼Œå…¶å€¼è¶Šå¤§ï¼Œå¯¹è¶Šç•Œçš„æƒ©ç½šå°±è¶Šå¤§ã€‚</p>

<h2 id="æœ€ä¼˜è§£">æœ€ä¼˜è§£</h2>

<p>å¦‚æœæˆ‘ä»¬æœ‰å¦‚ä¸‹ä¼˜åŒ–é—®é¢˜ï¼š</p>

\[x^{*}=\arg\min\limits_{x}f(x) \qquad s.t. \  g(x)\le0 \\\]

<p>é‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥æ•°ä¹˜æ³•æ¥å¾—åˆ°ä¸€ä¸ªæ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>

\[L(x,\lambda)=f(x)+{\lambda}g(x)\]

<p>å…¶ä¸­$\lambda&gt;0$ã€‚ç°è€ƒè™‘é’ˆå¯¹å‚æ•°$\lambda$æœ€å¤§åŒ–è¯¥å‡½æ•°ï¼š</p>

\[\lambda^{*}=\max\limits_{\lambda}L(x,\lambda)=f(x)+\max\limits_{\lambda}{\lambda}g(x)\]

<p>æ³¨æ„åˆ°$\lambda&gt;0$ï¼Œ$g(x)\le0$ï¼Œæ‰€ä»¥åœ¨æ»¡è¶³åŸé—®é¢˜çº¦æŸæ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œæœ‰ï¼š</p>

\[L(x,\lambda^{*})=f(x)\]

<p>æ‰€ä»¥åŸä¼˜åŒ–é—®é¢˜å¯ä»¥å†™æˆï¼š</p>

\[x^{*},\lambda^{*}=\arg\min\limits_{x}\max\limits_{\lambda}L(x,\lambda)\]

<p>åœ¨è§£ä¼˜åŒ–é—®é¢˜æ—¶ï¼Œå¦‚æœç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾ˆå®¹æ˜“å¾—åˆ°ä¸€ä¸ªå…¨å±€æœ€ä¼˜è§£ã€‚æ‹‰æ ¼æœ—æ—¥é—®é¢˜è¿˜æœ‰ä¸€ä¸ªå¯¹å¶é—®é¢˜ï¼š</p>

\[\lambda^{*},x^{*}=\arg\max\limits_{\lambda}\min\limits_{x}L(x,\lambda)\]

<p>åŸé—®é¢˜ä¸å¯¹å¶é—®é¢˜åŒè§£çš„å……è¦æ¡ä»¶ä¸ºKKTæ¡ä»¶ï¼š</p>

\[\begin{aligned}
\frac{\partial L(x^{*},\lambda^{*})}{\partial x}&amp;=0 \\
{\lambda}^{*}g(x^{*})&amp;=0 \\
g(x^{*})&amp;\le0 \\
\lambda^{*}&amp;\ge0 \\
\end{aligned}\]

<p>SVMé—®é¢˜æ˜¯ä¸€ä¸ªå¸¦çº¿æ€§ä¸ç­‰å¼çº¦æŸçš„æœ€ä¼˜åŒ–é—®é¢˜ï¼š</p>

\[\begin{aligned}
    \theta^{*},\lambda^{*}&amp;=\arg\min\limits_{\theta}\max\limits_{\lambda}L(\theta,\lambda) \\
    &amp;=\arg\min\limits_{\theta}\max\limits_{\lambda}\frac{1}{2}||\theta||_{2}^{2}-\sum_{i=1}^{m}\lambda_{i}[y^{i}\cdot{}(x^{i}\theta^{T}+\theta_{0})-1], \qquad s.t. \  \lambda_{i}\ge0
\end{aligned}\]

<p>å°†å…¶è½¬æˆå¯¹å¶é—®é¢˜æ¥è§£ï¼š</p>

\[\begin{aligned}
\lambda^{*},\theta^{*}&amp;=\arg\max\limits_{\lambda}\min\limits_{\theta}L(\theta,\lambda) \\
&amp;=\arg\max\limits_{\lambda}\min\limits_{\theta}\frac{1}{2}||\theta||_{2}^{2}-\sum_{i=1}^{m}\lambda_{i}[y^{i}\cdot{}(x^{i}\theta^{T}+\theta_{0})-1], \qquad s.t. \  \lambda_{i}\ge0
\end{aligned}\]

<p>ä»¤$\frac{\partial{L}}{\partial{\theta}}=\frac{\partial L}{\partial \theta_{0}}=0$å¾—ï¼š</p>

\[\begin{aligned}
\frac{\partial{L}}{\partial{\theta}}&amp;=\theta-\sum_{i=1}^{m}\lambda_{i}y^{i}x^{i}=0 \\
\frac{\partial{L}}{\partial{\theta_{0}}}&amp;=-\sum_{i=1}^{m}\lambda_{i}y^{i}=0 \\
\theta^{*}&amp;=\sum_{i=1}^{m}\lambda_{i}y^{i}x^{i}
\end{aligned}\]

<p>å°†æ‹‰æ ¼æœ—æ—¥å‡½æ•°å±•å¼€å¹¶ä»£å…¥æœ€ä¼˜$\theta^{*}$ï¼š</p>

\[\begin{aligned}
L(\theta^{*},\lambda)&amp;=\frac{1}{2}||\theta^{*}||_{2}-\sum_{i=1}^{m}\lambda_{i}[y^{i}\cdot{}(x^{i}{\theta^{*}}^{T}+\theta_{0})-1] \\
&amp;=\frac{1}{2}||\theta^{*}||_{2}-(\sum_{i=1}^{m}\lambda_{i}y^{i}x^{i})\cdot{\theta^{*}}^{T}-(\sum_{i=1}^{m}\lambda_{i}y^{i})\cdot\theta_{0}+\sum_{i=1}^{m}\lambda_{i} \\
&amp;=\frac{1}{2}\theta^{*}{\theta^{*}}^{T}-\theta^{*}{\theta^{*}}^{T}+\sum_{i=1}^{m}\lambda_{i} \\
&amp;=\sum_{i=1}^{m}\lambda_{i}-\frac{1}{2}\theta^{*}{\theta^{*}}^{T} \\
&amp;=\sum_{i=1}^{m}\lambda_{i}-\frac{1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\lambda_{i}\lambda_{j}y^{i}y^{j}x^{i}{x^{j}}^{T}
\end{aligned}\]

<p>æœ€å¤§åŒ–ä¸Šå¼å³å¯æ±‚å‡ºæœ€ä¼˜åŒ–å‚æ•°$\lambda^{*}$ï¼š</p>

\[\lambda^{*}=\arg\max\limits_{\lambda}L(\theta^{*},\lambda), \qquad s.t. \  \sum\limits_{i=1}^{m}\lambda_{i}y^{i}=0\]

<p>æœ€ä¼˜çš„SVMæ¨¡å‹è¾“å‡ºä¸ºï¼š</p>

\[\begin{aligned}
\hat{y}&amp;=
\left\{
\begin{aligned}
&amp;+1,  &amp;\hat{x}(\sum_{i=1}^{m}\lambda_{i}^{*}y^{i}x^{i})^{T}\ge+1\\
&amp;-1,  &amp;\hat{x}(\sum_{i=1}^{m}\lambda_{i}^{*}y^{i}x^{i})^{T}\le-1 \\
\end{aligned}
\right. \\
&amp;= \left\{
\begin{aligned}
&amp;+1,  &amp;\sum_{i=1}^{m}\lambda_{i}^{*}y^{i}\langle\hat{x},x^{i}\rangle\ge+1\\
&amp;-1,  &amp;\sum_{i=1}^{m}\lambda_{i}^{*}y^{i}\langle\hat{x},x^{i}\rangle\le+1\\
\end{aligned}
\right.
\end{aligned}\]

<p>å…¶ä¸­$\hat{x}$è¡¨ç¤ºå¾…é¢„æµ‹çš„æ ·æœ¬ï¼Œ$\hat{y}$è¡¨ç¤ºæ¨¡å‹å¯¹è¯¥æ ·æœ¬çš„é¢„æµ‹å€¼ã€‚å›é¡¾ä¸€ä¸‹æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>

\[max \ L(\lambda)=\frac{1}{2}||\theta^{*}||_{2}^{2}-\sum_{i=1}^{m}\lambda_{i}(y^{i}\cdot{}x^{i}{\theta^{*}}^{T}-1), \qquad s.t. \ \lambda_{i}\ge0\]

<p>æ³¨æ„åˆ°ï¼Œå¦‚æœæŸæ ·æœ¬$x^{i}$ä¸æ˜¯æ”¯æŒå‘é‡ï¼Œé‚£ä¹ˆæœ‰$y^{i}\cdot{x^{i}\theta^{T}}-1&gt;0$ï¼Œä¸ºäº†æœ€å¤§åŒ–æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼Œå¿…å®šæœ‰$\lambda_{i}^{<em>}=0$ï¼Œå³éæ”¯æŒå‘é‡å¯¹åº”çš„$\lambda^{</em>}$å‡ä¸º0ï¼Œä»ç†è®ºä¸Šè¯´æ˜äº†SVMçš„å†³ç­–è¾¹ç•Œåªè·Ÿæ”¯æŒå‘é‡æœ‰å…³ã€‚</p>

<h2 id="æ ¸å‡½æ•°">æ ¸å‡½æ•°</h2>

<p>ä»¥ä¸Šè®¨è®ºéƒ½æ˜¯åŸºäºæ•°æ®é›†çº¿æ€§å¯åˆ†çš„å‡è®¾ä¸‹ï¼Œå¦‚æœæ•°æ®é›†åœ¨åŸå§‹ç»´åº¦ä¸‹çº¿æ€§ä¸å¯åˆ†æ€ä¹ˆåŠï¼Ÿæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ä¸ºæ•°æ®é›†å¢åŠ é«˜ç»´åº¦ç‰¹å¾ã€‚å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªäºŒç»´æ•°æ®é›†ï¼š</p>

\[X=
\left[
\begin{matrix}
 x_{1}^{(1)}&amp;x_{2}^{(1)} \\
x_{1}^{(2)}&amp;x_{2}^{(2)} \\
 \vdots \\
 x_{1}^{(m)}&amp;x_{2}^{(m)} \\
\end{matrix}
\right]\]

<p>æ­¤æ•°æ®é›†äºŒç»´å¹³é¢ä¸Šçº¿æ€§ä¸å¯åˆ†ï¼Œä½†æ˜¯åœ¨ç»ä¸€ä¸ªå˜æ¢å‡½æ•°$\phi(x)$ä½œç”¨ä¸‹ç”Ÿæˆçš„æ–°æ•°æ®é›†æ˜¯çº¿æ€§å¯åˆ†çš„ï¼š</p>

\[\phi(x_{1},x_{2})=(x_{1}^2,\sqrt{2}x_{1}x_{2},x_{2}^2)\]

<p>å¯¹äºå‡ç»´åçš„æ–°æ•°æ®é›†$\phi(X)â€‹$ï¼ŒSVMæ‰€åšçš„è®¡ç®—å˜æˆäº†ï¼š</p>

\[\begin{aligned}
pred&amp;=\sum_{i=1}^{m}\lambda_{i}y^{(i)}\langle\phi(\hat{x}),\phi(x^{(i)})\rangle \\
&amp;=\sum_{i=1}^{m}\lambda_{i}y^{(i)}\langle(\hat{x}_{1}^2,\sqrt{2}\hat{x}_{1}\hat{x}_{2},\hat{x}_{2}^2),({x_{1}^{(i)}}^2,\sqrt{2}x_{1}^{(i)}x_{2}^{(i)},{x_{2}^{(i)}}^2)\rangle \\
&amp;=\sum_{i=1}^{m}\lambda_{i}y^{(i)}(\hat{x}_{1}^{2}{x_{1}^{(i)}}^{2}+2\hat{x}_{1}x_{1}^{(i)}\hat{x}_{2}x_{2}^{(i)}+\hat{x}_{2}^{2}{x_{2}^{(i)}}^{2}) \\
&amp;=\sum_{i=1}^{m}\lambda_{i}y^{(i)}(\hat{x}_{1}x_{1}^{(i)}+\hat{x}_{2}x_{2}^{(i)})^{2} \\
&amp;=\sum_{i=1}^{m}\lambda_{i}y^{(i)}\langle(\hat{x}_{1},\hat{x}_{2}),(x_{1}^{(1)},x_{2}^{(2)})\rangle^{2} \\
&amp;=\sum_{i=1}^{m}\lambda_{i}y^{(i)}\langle\hat{x},x^{(i)}\rangle^{2}
\end{aligned}\]

<p>é€šè¿‡ä¸Šé¢çš„å˜æ¢ï¼Œä¸éš¾çœ‹å‡ºï¼Œåœ¨å°†æ•°æ®é›†å‡ç»´ä¹‹åï¼ŒSVMè®­ç»ƒã€é¢„æµ‹æ—¶çš„è®¡ç®—å…¶å®å°±å¯ä»¥è½¬åŒ–ä¸ºåŸå§‹ç‰¹å¾çš„è®¡ç®—ï¼Œé‚£ä¹ˆä½•å¿…è¦å¯¹æ•°æ®é›†è¿›è¡Œå‡ç»´æ“ä½œå‘¢ï¼Ÿ</p>

<p>ä»¥ä¸Šè¿°æ•°æ®é›†ä¸ºä¾‹ï¼Œé€‰å–ä¸€ä¸ªå‡½æ•°$\kappa(x_{1},x_{2})=\langle{x_{1}},{x_{2}}\rangle^{2}$ï¼Œç”¨å®ƒæ¥ä»£æ›¿SVMçš„å†…ç§¯è®¡ç®—ï¼š</p>

\[\hat{y}=\left\{
\begin{aligned}
&amp;+1,  &amp;\sum_{i=1}^{m}\lambda_{i}y^{i}\kappa(\hat{x},x^{i})\ge+1\\
&amp;-1,  &amp;\sum_{i=1}^{m}\lambda_{i}y^{i}\kappa(\hat{x},x^{i})\ge+1\\
\end{aligned}
\right.\]

<p>è¿™æ ·ä¸€æ¥ï¼Œè¿™ä¸ªSVMæ¨¡å‹çš„è®­ç»ƒã€é¢„æµ‹è¿‡ç¨‹å°±ç­‰åŒäºåœ¨é«˜ç»´ç©ºé—´è¿›è¡Œï¼Œå³è¾¾åˆ°äº†çº¿æ€§åˆ’åˆ†æ•°æ®é›†çš„ç›®çš„ï¼Œä¹Ÿæ²¡æœ‰å¢åŠ å¤æ‚çš„è¿ç®—ï¼Œå…¶ä¸­$\kappa(x_{1},x_{2})$è¢«ç§°ä¸º<strong>æ ¸å‡½æ•°</strong>(kernel function)ï¼Œè¿™ç§æ–¹æ³•è¢«ç§°ä¸º<strong>æ ¸æŠ€å·§</strong>(kernel trick)ã€‚</p>

<p>ç°å®ä»»åŠ¡ä¸­ï¼Œä¸€èˆ¬æ˜¯ä¸çŸ¥é“è¦å¯¹æ•°æ®åº”ç”¨æ€æ ·çš„å‡ç»´å‡½æ•°$\phi(x)$æ‰èƒ½ä½¿å¾—æ•°æ®é›†çº¿æ€§å¯åˆ†ï¼Œé‚£ä¹ˆè‡ªç„¶å°±éš¾ä»¥æ±‚å¾—è®¡ç®—é«˜ç»´ç©ºé—´çš„æ ¸å‡½æ•°$\kappa(\cdot,\cdot)$ï¼Œç”šè‡³ä¸çŸ¥é“æŸå‡½æ•°æ˜¯å¦èƒ½è¢«ç”¨ä½œæ ¸å‡½æ•°ã€‚</p>

<p>ç®€å•æ¥è¯´ï¼Œä¸€ä¸ªå‡½æ•°è¦èƒ½è¢«å½“åšæ ¸å‡½æ•°ï¼Œéœ€è¦æ»¡è¶³<strong>Mercerâ€™s condition</strong>ï¼Œå³å¯¹ç§°å‡½æ•°$\kappa(\cdot,\cdot)$çš„æ ¸çŸ©é˜µå¿…é¡»æ»¡è¶³æ’ä¸ºåŠæ­£å®šçŸ©é˜µã€‚</p>

<p>å¸¸ç”¨çš„æ ¸å‡½æ•°æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">æ ¸å‡½æ•°</th>
      <th style="text-align: center">è¡¨è¾¾å¼</th>
      <th style="text-align: center">è¯´æ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">linear</td>
      <td style="text-align: center">$\kappa(x,y)={\langle}x,y{\rangle}$</td>
      <td style="text-align: center">è®¡ç®—åŸå§‹ç©ºé—´çš„å†…ç§¯</td>
    </tr>
    <tr>
      <td style="text-align: center">polynomial</td>
      <td style="text-align: center">$\kappa(x,y)=(\gamma{\langle}x,y{\rangle}+c)^{d}$</td>
      <td style="text-align: center">è®¡ç®—dç»´ç©ºé—´çš„å†…ç§¯</td>
    </tr>
    <tr>
      <td style="text-align: center">Radial Basis Function</td>
      <td style="text-align: center">$\kappa(x,y)=exp(-\gamma\vert{x-y}\vert^{2})$</td>
      <td style="text-align: center">-</td>
    </tr>
    <tr>
      <td style="text-align: center">sigmoid</td>
      <td style="text-align: center">$tanh(\gamma{\langle}x,y{\rangle}+c)$</td>
      <td style="text-align: center">-</td>
    </tr>
  </tbody>
</table>

<h2 id="è½¯é—´éš”svm">è½¯é—´éš”SVM</h2>

<p><strong>æ³¨æ„ï¼šè½¯é—´éš”ç›¸å½“äºSVMçš„æ­£åˆ™åŒ–</strong></p>

<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä»¥ä¸Šè®¨è®ºéƒ½æ˜¯å‡è®¾SVMåœ¨åŸå§‹ç©ºé—´æˆ–è€…é«˜ç»´ç©ºé—´å°†æ•°æ®é›†å®Œå…¨çº¿æ€§åˆ†å‰²å¼€æ¥ï¼Œä½†æ˜¯å°†æ•°æ®å®Œç¾çš„çº¿æ€§åˆ†å¼€æ˜¯å¦ä¼šäº§ç”Ÿæˆ–æ‹Ÿåˆï¼Ÿç”±æ­¤å¼•å‡ºè½¯é—´éš”SVMã€‚å…ˆå‰è®¨è®ºçš„SVMçº¦æŸæ¡ä»¶ä¸ºï¼š</p>

\[y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1\]

<p>è¿™è¡¨ç¤ºçš„æ˜¯æ‰€æœ‰æ ·æœ¬éƒ½åœ¨è¯¥ç±»å¯¹åº”çš„æ”¯æŒå‘é‡çš„å¤–ä¾§ï¼Œé‚£ä¹ˆï¼Œç°åœ¨å…è®¸ä¸€å®šæ•°é‡çš„æ ·æœ¬ä¸åœ¨å¤–ä¾§ï¼Œè€Œåœ¨å†…ä¾§ï¼Œéœ€è¦æ»¡è¶³çš„æ¡ä»¶å˜ä¸ºï¼š</p>

\[y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1-\xi_{i}\]

<p>å…¶ä¸­$\xi$ä¸ºæ¾å¼›å˜é‡ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªå˜é‡ä¸èƒ½è¿‡å¤§ï¼Œå¦åˆ™çº¦æŸå°±æ— æ„ä¹‰äº†ï¼Œéœ€è¦å¯¹å®ƒè¿›è¡Œé™åˆ¶ï¼Œå°†å…¶åŠ å…¥åˆ°æœ€å°åŒ–ç›®æ ‡å‡½æ•°ä¸­ï¼ŒåŸSVMçš„ä¼˜åŒ–é—®é¢˜å°±å˜æˆäº†ï¼š</p>

\[\begin{aligned}
min \ \frac{1}{2}||\theta||_{2}+C\sum_{i=1}^{m}\xi_{i}, \qquad s.t.&amp; \  y^{(i)}(x^{(i)}\theta^{T}+\theta_{0})\ge1-\xi_{i},i=1,...m \\
&amp; \  \xi_{i}\ge0,i=1,...m \\
\end{aligned}\]

<p>å…¶ä¸­$C$ä¸ºæƒè¡¡ç³»æ•°ï¼Œå…¶å€¼è¶Šå¤§å¯¹æ¾å¼›å˜é‡çš„çº¦æŸè¶Šå¤§ã€‚æ­¤æ—¶çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°å˜ä¸ºï¼š</p>

\[\begin{aligned}
\max\limits_{\lambda,\gamma}\ \min\limits_{\theta,\xi} L(\theta,\xi,\lambda,\gamma)&amp;=\frac{1}{2}||\theta||_{2}^{2}+C\sum\limits_{i=1}^{m}\xi_{i}-\sum_{i=1}^{m}\lambda_{i}(y^{i}\cdot{}x^{i}\theta^{T}+y^{i}\theta_{0}-1+\xi_{i})-\sum_{i=1}^{m}\gamma_{i}\xi_{i}
\end{aligned}\]

<p>ä»¤$\frac{\partial{L}}{\partial{\theta}}=\frac{\partial{L}}{\partial{\theta_{0}}}=\frac{\partial{L}}{\partial{\xi_{i}}}=0$å¾—ï¼š</p>

\[\left\{
\begin{aligned}
&amp;\theta^{*}=\sum_{i=1}^{m}\lambda_{i}y^{i}x^{i} \\
&amp;-\sum\limits_{i=1}^{m}\lambda_{i}y^{i}=0 \\
&amp;C=\lambda_{i}+\gamma_{i} \\
\end{aligned}
\right.\]

<p>å°†æœ€ä¼˜$\theta^{*}$å¸¦å…¥å¾—ï¼š</p>

\[\begin{aligned}
L(\lambda,\xi)&amp;=\frac{1}{2}||\theta^{*}||_{2}^{2}+\lambda_{i}\sum_{i=1}^{m}\xi_{i}+\gamma_{i}\sum_{i=1}^{m}\xi_{i}-\sum_{i=1}^{m}\lambda_{i}y^{i}x^{x}{\theta^{*}}^{T}+\sum_{i=1}^{m}\lambda_{i}-\sum_{i=1}^{m}\lambda_{i}\xi_{i}-\sum_{i=1}^{m}\gamma_{i}\xi_{i} \\
&amp;=\frac{1}{2}\theta^{*}{\theta^{*}}^{T}-(\sum_{i=1}^{m}\lambda_{i}y^{i}x^{i})\cdot{\theta^{*}}^{T}+\sum_{i=1}^{m}\lambda_{i} \\
&amp;=\sum_{i=1}^{m}\lambda_{i}-\frac{1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\lambda_{i}\lambda_{j}y^{i}y^{j}x^{i}{x^{j}}^{T}
\end{aligned}\]

<p>å¯ä»¥çœ‹åˆ°éœ€è¦æœ€å¤§åŒ–çš„ç›®æ ‡å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡å¤šäº†ä¸€ä¸ªçº¦æŸé¡¹$C=\lambda_{i}+\xi_{i}$ï¼Œå®Œæ•´å†™å‡ºæ¥å¦‚ä¸‹æ‰€ç¤ºï¼š</p>

\[\begin{aligned}
\max\limits_{\lambda}\ L(\lambda)&amp;=\sum_{i=1}^{m}\lambda_{i}-\frac{1}{2}\sum_{i=1}^{m}\sum_{j=1}^{m}\lambda_{i}\lambda_{j}y^{i}y^{j}x^{i}{x^{j}}^{T} \\
s.t. \ &amp; 0\le\lambda_{i}\le{C}, \  \sum\limits\lambda_{i}y^{i}=0
\end{aligned}\]

<p>SVMçš„å…·ä½“ä¼˜åŒ–ç®—æ³•è¯·å‚é˜…SMOä¸€ç« ï¼Œå®ç°æŒ‡å¯¼ä¹Ÿåœ¨é‚£ä¸€ç« ã€‚è¿™é‡Œåªæ”¾å‡ºå®Œæ•´ä»£ç ï¼š<a href="https://github.com/Daya-Jin/ML_for_learner/blob/master/svm/SVC.py">å®Œæ•´ä»£ç </a></p>

<h2 id="svr">SVR</h2>

<p>ï¼ˆå¾…è¡¥å……ï¼‰</p>

<h2 id="svm-vs-lr">SVM V.S. LR</h2>

<p>SVMä¸LRæ˜¯ç»å¸¸è¢«ç”¨æ¥æ¯”è¾ƒçš„ä¸€å¯¹æ¨¡å‹ã€‚</p>

<p>é¦–å…ˆï¼Œä»æ•°å­¦å½¢å¼ä¸Šæ¥ä½œå¯¹æ¯”ï¼Œç„¶åå†å»æ¢ç©¶èƒŒåçš„æ ¹æºã€‚å¯¹äºæœºå™¨å­¦ä¹ æ¨¡å‹è€Œè¨€ï¼Œæœ€æ ¸å¿ƒçš„éƒ¨åˆ†å°±æ˜¯å…¶æŸå¤±å‡½æ•°æˆ–ç›®æ ‡å‡½æ•°ï¼Œè¯¥å‡½æ•°å†³å®šäº†ç®—æ³•çš„ç›®çš„ä¸ä¼˜åŒ–æ–¹æ³•ã€‚</p>

<p>LRçš„æŸå¤±å‡½æ•°ä¸ºï¼š</p>

\[\begin{aligned}
    Loss_{LR}&amp;=\sum_{i}[y\ln\frac{1}{\hat{y}}+(1-y)\ln\frac{1}{1-\hat{y}}] \\
    &amp;=\sum_{i}[-y*x\theta^{T}+ln(1+e^{x\theta^{T}})] \\
\end{aligned}\]

<p>SVMçš„æŸå¤±å‡½æ•°ä¸ºï¼š</p>

\[\begin{aligned}
    Loss_{SVM}&amp;=\frac{1}{2}||\theta||_{2}+\sum\limits_{i}max(0,1-y\hat{y}) \\
    &amp;=\frac{1}{2}||\theta||_{2}+\sum\limits_{i}max(0,1-y(x\theta+\theta_{0})) \\
\end{aligned}\]

<p>ä¸éš¾å‘ç°ï¼ŒSVMä¸­çš„$max(0,1-y\hat{y})$é¡¹ï¼Œåœ¨$y\hat{y}{\ge}1$æ—¶ä¸º0ï¼Œå³SVMå®é™…ä¸Šå¯¹æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬æ˜¯ä¸è®¡å…¥lossçš„ã€‚è€Œåè§‚LRï¼Œä¸éš¾å‘ç°LRåœ¨æ•°å­¦å½¢å¼ä¸Šçš„lossæ˜¯æ— æ³•å–å¾—$0$å€¼çš„ï¼Œè¿™æ˜¯å› ä¸ºsigmoidå‡½æ•°çš„æ€§è´¨å°±ä¸å…è®¸æ¨¡å‹ç²¾ç¡®åœ°è¾“å‡º${0,1}$å€¼ï¼Œç†è®ºä¸Šåªæœ‰åœ¨æ— ç©·è¿œå¤„æ‰èƒ½å–å¾—ã€‚å¯ä»¥å‡è®¾ä¸€ä¸ªå­˜åœ¨ç¦»ç¾¤ç‚¹çš„åœºæ™¯ï¼Œè‹¥SVMå¯¹è¯¥ç¦»ç¾¤ç‚¹å·²èƒ½æ­£ç¡®åˆ†ç±»ï¼Œé‚£ä¹ˆåœ¨è®­ç»ƒæ—¶å°±ä¸ä¼šå†å°†è¯¥ç‚¹è€ƒè™‘è¿›å»ï¼Œè€ŒLRåˆ™ä¼šæ”¶è¯¥ç¦»ç¾¤ç‚¹çš„å½±å“ã€‚æ‰€ä»¥å¯ä»¥çœ‹å‡ºï¼ŒSVMå¯¹ç¦»ç¾¤ç‚¹çš„æŠ—æ€§è¦é«˜äºLRã€‚è€Œä¸”ï¼ŒLRçš„å†³ç­–è¾¹ç•Œä¼šå—ä¸¤ä¸ªç±»åˆ«æ ·æœ¬åˆ†å¸ƒçš„å½±å“ï¼Œè€ŒSVMåˆ™ä¸ä¼šï¼Œå…¶å†³ç­–è¾¹ç•Œåªå—æ”¯æŒå‘é‡çš„å½±å“ã€‚</p>

<p>åŒæ—¶è¿˜åœ¨æŸå¤±å‡½æ•°ä¸­å‘ç°ï¼ŒSVMè‡ªå¸¦L2æ­£åˆ™é¡¹ï¼ŒLRåˆ™ä¸å¸¦ã€‚</p>

<p>ç„¶åï¼Œä¸¤è€…çš„å‡ºå‘ç‚¹å°±ä¸åŒã€‚LRæ˜¯ä»æ¦‚ç‡çš„æ€æƒ³å‡ºå‘ï¼Œä½¿ç”¨ä¸€ä¸ªçº¿æ€§å›å½’å»æ‹Ÿåˆæ­£åäº‹ä»¶çš„å¯¹æ•°æœºç‡ï¼›è€ŒSVMçš„æ€æƒ³æ˜¯å¯å‘æ€§çš„ï¼Œç›´æ¥å­¦ä¹ ä¸€ä¸ªæœ€å¤§é—´éš”è¶…å¹³é¢å»å°†ä¸¤ä¸ªç±»åˆ«åˆ†å¼€ã€‚</p>

<p>ç„¶åå†çœ‹ä¸¤è€…çš„è¾“å‡ºå‡½æ•°ï¼ŒLRçš„é¢„æµ‹å‡½æ•°ï¼š</p>

\[\begin{aligned}
\hat{y}_{LR}&amp;=\frac{1}{1+e^{-x\theta^{T}}} \\
\end{aligned}\]

<p>SVMçš„é¢„æµ‹å‡½æ•°ï¼š</p>

\[\begin{aligned}
    \hat{y}_{SVM}&amp;=
    \left\{
    \begin{aligned}
        &amp;+1,  &amp;\sum_{i=1}^{m}\lambda_{i}^{*}y^{i}\langle\hat{x},x^{i}\rangle\ge+1\\
        &amp;-1,  &amp;\sum_{i=1}^{m}\lambda_{i}^{*}y^{i}\langle\hat{x},x^{i}\rangle\le+1\\
    \end{aligned}
    \right.
\end{aligned}\]

<p>ç”±äºSMVçš„é¢„æµ‹å‡½æ•°ä¸­å­˜åœ¨ä¸¤è®­ç»ƒæ ·æœ¬çš„å†…ç§¯é¡¹ï¼Œæ‰€ä»¥æ ¸æŠ€å·§èƒ½å¾ˆè‡ªç„¶è€Œç„¶çš„ä¸SVMç›¸ç»“åˆï¼›é™¤äº†è¿™ä¸ªåŸå› ä¹‹å¤–ï¼ŒSVMä¸­çš„æ‹‰æ ¼æœ—æ—¥å‚æ•°$\lambda$ï¼Œéæ”¯æŒå‘é‡çš„è¯¥å‚æ•°å€¼æ˜¯ä¸º$0$çš„ï¼Œæ‰€ä»¥åœ¨è®¡ç®—å†³ç­–è¾¹ç•Œæ—¶çš„è®¡ç®—é‡å¹¶ä¸é«˜ï¼Œè¿™ä¹Ÿæ˜¯æ ¸æŠ€å·§å¸¸ç”¨äºSVMçš„åŸå› ä¹‹ä¸€ã€‚</p>

<p>æœ€åï¼Œä¸¤è€…çš„ä¼˜åŒ–å¤æ‚åº¦ä¸ä¸€æ ·ï¼ŒLRç”±äºæ¨¡å‹æœ¬èº«ç®€å•ï¼Œå¯ä»¥ä½¿ç”¨è¿­ä»£çš„æ¢¯åº¦ä¸‹é™æ³•è¿›è¡Œä¼˜åŒ–ï¼›è€ŒSVMç›®å‰æˆç†Ÿçš„ä¼˜åŒ–æ–¹æ³•å°±æ˜¯SMOç®—æ³•ã€‚å¦å¤–ï¼Œç”±äºSVMä½¿ç”¨äº†â€œè·ç¦»â€çš„æ¦‚å¿µï¼Œæ‰€ä»¥å¯¹æ•°æ®åšå½’ä¸€åŒ–å¤„ç†æ˜¯æœ‰å¥½å¤„çš„ï¼Œè¿˜ç”±äºç»´åº¦è¯…å’’çš„åŸå› ï¼Œåœ¨é«˜ç»´ç©ºé—´ä¸‹è·ç¦»çš„æ¦‚å¿µä¼šå˜å¾—ååˆ†æŠ½è±¡ï¼Œæ‰€ä»¥åœ¨é«˜ç»´æƒ…å†µä¸‹ï¼Œä¼šæ›´å€¾å‘äºå®ç”¨LRã€‚</p>

<h2 id="å…³äºå¯¹å¶é—®é¢˜">å…³äºå¯¹å¶é—®é¢˜</h2>

<p>è‡³äºä¸ºä»€ä¹ˆè¦å°†SVMçš„åŸé—®é¢˜è½¬åŒ–æˆå¯¹å¶é—®é¢˜ï¼Œåœ¨ç½‘ä¸Šæœåˆ°æœ‰å¦‚ä¸‹å‡ ç§è¯´æ³•ï¼š</p>

<ul>
  <li>å¯¹å¶é—®é¢˜çš„è§£ä¸­æœ‰$\langle\hat{x},x^{i}\rangle$è¿™æ ·çš„å†…ç§¯å½¢å¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¼•å…¥æ ¸æŠ€å·§</li>
  <li>ä»å¯¹å¶é—®é¢˜çš„æ±‚è§£è¿‡ç¨‹å¯ä»¥çœ‹å‡ºåªéœ€è¦æ±‚å‡ºæœ€ä¼˜çš„$\lambda^{<em>}$å³å¯ï¼Œè€Œ$\lambda$çš„æ•°é‡ç­‰åŒäºæ ·æœ¬çš„æ•°é‡ï¼Œä½†æ˜¯éæ”¯æŒå‘é‡å¯¹åº”çš„$\lambda_{i}^{</em>}$å‡ä¸ºé›¶ï¼Œæ‰€ä»¥çœŸæ­£è¦æ±‚è§£çš„$\lambda$æ•°é‡å¹¶ä¸å¤šï¼›åä¹‹ï¼ŒåŸé—®é¢˜éœ€è¦æ±‚è§£$\theta^{<em>}$ï¼Œè€Œ$\theta^{</em>}$çš„æ•°é‡ç­‰åŒäºæ•°æ®çš„ç»´åº¦ã€‚</li>
</ul>
:ET